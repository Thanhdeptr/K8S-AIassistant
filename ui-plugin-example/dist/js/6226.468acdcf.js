(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[6226],{16226:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Q});var s=r(20641),a=r(90033);function o(e,t,r,o,c,n){const i=(0,s.g2)("ExplorerProjectsNamespaces");return(0,s.uX)(),(0,s.Wv)(i,(0,a._B)((0,s.Ng)(e.$attrs)),null,16)}const c={class:"project-namespaces outlet"},n={class:"group-tab"},i={class:"project-name"},p={key:0,class:"description text-muted text-small"},l={class:"right"},u={key:0},m={key:1,class:"text-muted"},d={class:"namespace-name"},h={key:1},j={key:2,class:"icon icon-istio ml-5"},g={key:3,class:"icon icon-lock ml-5"},b={class:"main-row"},v=["colspan"],f={class:"main-row"},N=["colspan"];function P(e,t,r,o,P,y){const w=(0,s.g2)("router-link"),L=(0,s.g2)("Masthead"),k=(0,s.g2)("ExtensionPanel"),C=(0,s.g2)("ButtonMultiAction"),S=(0,s.g2)("ResourceTable"),A=(0,s.g2)("MoveModal"),$=(0,s.gN)("clean-html"),E=(0,s.gN)("trim-whitespace"),x=(0,s.gN)("clean-tooltip");return(0,s.uX)(),(0,s.CE)("div",c,[(0,s.bF)(L,{schema:P.projectSchema,"type-display":e.t("projectNamespaces.label"),resource:P.MANAGEMENT.PROJECT,"favorite-resource":P.VIRTUAL_TYPES.PROJECT_NAMESPACES,"create-location":y.createProjectLocation,"create-button-label":e.t("projectNamespaces.createProject"),"show-incremental-loading-indicator":y.showIncrementalLoadingIndicator,"load-resources":P.loadResources,"load-indeterminate":P.loadIndeterminate},(0,s.eX)({_:2},[y.showCreateNsButton?{name:"extraActions",fn:(0,s.k6)((()=>[(0,s.bF)(w,{to:y.createNamespaceLocationFlatList(),class:"btn role-primary mr-10","data-testid":"create_project_namespaces"},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(e.t("projectNamespaces.createNamespace")),1)])),_:1},8,["to"])])),key:"0"}:void 0]),1032,["schema","type-display","resource","favorite-resource","create-location","create-button-label","show-incremental-loading-indicator","load-resources","load-indeterminate"]),t[9]||(t[9]=(0,s.eW)()),(0,s.bF)(k,{resource:{},type:P.extensionType,location:P.extensionLocation},null,8,["type","location"]),t[10]||(t[10]=(0,s.eW)()),(0,s.bF)(S,(0,s.v6)({ref:"table"},{...e.$attrs,class:null},{class:"table project-namespaces-table",schema:P.schema,headers:y.headers,rows:y.filteredRows,groupable:!0,"sort-generation-fn":y.sortGenerationFn,loading:y.loading,"group-tooltip":"resourceTable.groupBy.project","key-field":"_key"}),(0,s.eX)({"group-by":(0,s.k6)((r=>[(0,s.Lk)("div",{class:(0,a.C4)(["project-bar",{"has-description":y.projectDescription(r.group)}])},[(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",n,[(0,s.bo)((0,s.Lk)("div",i,null,512),[[$,y.projectLabel(r.group)]]),t[0]||(t[0]=(0,s.eW)()),y.projectDescription(r.group)?((0,s.uX)(),(0,s.CE)("div",p,(0,a.v_)(y.projectDescription(r.group)),1)):(0,s.Q3)("",!0)])),[[E]]),t[2]||(t[2]=(0,s.eW)()),(0,s.Lk)("div",l,[y.isNamespaceCreatable&&(y.canSeeProjectlessNamespaces||r.group.key!==y.notInProjectKey)?((0,s.uX)(),(0,s.Wv)(w,{key:0,class:"create-namespace btn btn-sm role-secondary mr-5",to:y.createNamespaceLocation(r.group)},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(e.t("projectNamespaces.createNamespace")),1)])),_:2},1032,["to"])):(0,s.Q3)("",!0),t[1]||(t[1]=(0,s.eW)()),(0,s.bF)(C,{class:"project-action mr-10",borderless:!0,"aria-label":e.t("projectNamespaces.tableActionsLabel",{resource:y.projectResource(r.group)}),invisible:!y.showProjectActionButton(r.group),onClick:e=>y.showProjectAction(e,r.group)},null,8,["aria-label","invisible","onClick"])])],2)])),"cell:project":(0,s.k6)((({row:e})=>[e.project?((0,s.uX)(),(0,s.CE)("span",u,(0,a.v_)(e.project.nameDisplay),1)):((0,s.uX)(),(0,s.CE)("span",m,"â€“"))])),"cell:name":(0,s.k6)((({row:r})=>[(0,s.Lk)("div",d,[r.detailLocation&&!r.hideDetailLocation?((0,s.uX)(),(0,s.Wv)(w,{key:0,to:r.detailLocation},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(r.name),1)])),_:2},1032,["to"])):((0,s.uX)(),(0,s.CE)("span",h,(0,a.v_)(r.name),1)),t[3]||(t[3]=(0,s.eW)()),r.injectionEnabled?(0,s.bo)(((0,s.uX)(),(0,s.CE)("i",j,null,512)),[[x,e.t("projectNamespaces.isIstioInjectionEnabled")]]):(0,s.Q3)("",!0),t[4]||(t[4]=(0,s.eW)()),r.hasSystemLabels?(0,s.bo)(((0,s.uX)(),(0,s.CE)("i",g,null,512)),[[x,y.getPsaTooltip(r)]]):(0,s.Q3)("",!0)])])),"main-row:fake-empty":(0,s.k6)((({fullColspan:t})=>[(0,s.Lk)("tr",f,[(0,s.Lk)("td",{class:"empty text-center",colspan:t},(0,a.v_)(e.t("projectNamespaces.noProjectNoNamespaces")),9,N)])])),_:2},[(0,s.pI)(y.projectsWithoutNamespaces,((t,r)=>({name:y.slotName(t),fn:(0,s.k6)((({fullColspan:t})=>[(0,s.Lk)("tr",b,[(0,s.Lk)("td",{class:"empty text-center",colspan:t},(0,a.v_)(e.t("projectNamespaces.noNamespaces")),9,v)])]))})))]),1040,["schema","headers","rows","sort-generation-fn","loading"]),t[11]||(t[11]=(0,s.eW)()),(0,s.bF)(A,{onMoving:y.clearSelection},null,8,["onMoving"])])}var y=r(66278),w=r(1822),L=r(31645),k=r(65843),C=r(55823),S=r(46405),A=r(25803),$=r(92959),E=r(21399),x=r(86691),_=r(63606),F=r(71518),M=r(18597),T=r(83586),R=r(42838),I=r.n(R),O=r(71883);const W={name:"ListProjectNamespace",components:{ExtensionPanel:$.A,Masthead:E.A,MoveModal:_.A,ResourceTable:w.A,ButtonMultiAction:F.A},mixins:[T.A],props:{createProjectLocationOverride:{type:Object,default:()=>null},createNamespaceLocationOverride:{type:Object,default:()=>null}},async fetch(){const e=this.$store.getters["currentStore"](C.CU);this.harvesterResourceQuotaSchema=this.$store.getters[`${e}/schemaFor`](C.rk.RESOURCE_QUOTA),this.schema=this.$store.getters[`${e}/schemaFor`](C.CU),this.projectSchema=this.$store.getters["management/schemaFor"](C.Mc.PROJECT),this.schema&&(await this.$fetchType(C.CU),this.projects=await this.$store.dispatch("management/findAll",{type:C.Mc.PROJECT,opt:{force:!0}}))},data(){return{loadResources:[C.CU],loadIndeterminate:!0,harvesterResourceQuotaSchema:null,schema:null,projects:[],projectSchema:null,extensionType:A.c7.PANEL,extensionLocation:A.W7.RESOURCE_LIST,MANAGEMENT:C.Mc,VIRTUAL_TYPES:C.cG,defaultCreateProjectLocation:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:C.Mc.PROJECT}}}},computed:{...(0,y.L8)(["currentCluster","currentProduct"]),namespaces(){const e=this.$store.getters["currentStore"](C.CU);return this.$store.getters[`${e}/all`](C.CU)},loading(){return!(!this.currentCluster||this.namespaces.length)&&this.$fetchState.pending},showIncrementalLoadingIndicator(){return this.perfConfig?.incrementalLoading?.enabled},isNamespaceCreatable(){return(this.schema?.collectionMethods||[]).includes("POST")},isHarvester(){return this.$store.getters["currentProduct"].inStore===O.T3},headers(){const e=[L.c4,L.o_];if("none"===this.groupPreference){const t={name:"project",label:this.t("tableHeaders.project"),value:"project.nameDisplay",sort:["projectNameSort","nameSort"]};e.push(t)}return this.isHarvester&&this.harvesterResourceQuotaSchema&&e.push(L.Si),e.push(L.K),e},projectIdsWithNamespaces(){const e=this.rows.map((e=>e.projectId)).filter((e=>e));return(0,k.sb)(e)},clusterProjects(){const e=this.currentCluster.id,t=this.$store.getters["management/all"](C.Mc.PROJECT);if(this.currentProduct?.customNamespaceFilter&&this.currentProduct?.inStore&&this.$store.getters[`${this.currentProduct.inStore}/filterProject`])return this.$store.getters[`${this.currentProduct.inStore}/filterProject`];const r=t.filter((t=>t.spec.clusterName===e));return r},projectsWithoutNamespaces(){return this.activeProjects.filter((e=>!this.projectIdsWithNamespaces.find((t=>e?.id?.endsWith(`/${t}`)))))},rowsWithFakeNamespaces(){const e=this.projectsWithoutNamespaces.map((e=>({groupByLabel:`resourceTable.groupLabel.notInAProject-${e.id}`,isFake:!0,mainRowKey:e.id,nameDisplay:e.spec?.displayName,project:e,availableActions:[]})));return this.showMockNotInProjectGroup&&e.push({groupByLabel:this.t("resourceTable.groupLabel.notInAProject"),mainRowKey:"fake-empty"}),[...this.rows,...e]},createProjectLocation(){return this.createProjectLocationOverride||this.defaultCreateProjectLocation},groupPreference:(0,x.mapPref)(x.GROUP_RESOURCES),activeNamespaceFilters(){return this.$store.getters["activeNamespaceFilters"]},activeProjectFilters(){const e={};for(const t of this.activeNamespaceFilters){const[r,s]=t.split("://",2);"project"===r&&(e[s]=!0)}return e},activeProjects(){const e=this.$store.getters["activeNamespaceFilters"];return e.includes(M.pF)&&0===Object.keys(this.activeProjectFilters).length?[]:this.userIsFilteringForSpecificNamespaceOrProject()?this.clusterProjects.filter((e=>{const t=e.id.split("/")[1];return!!this.activeProjectFilters[t]})):this.clusterProjects},activeNamespaces(){const e=this.$store.getters["namespaces"]();return this.namespaces.filter((t=>!!e[t.metadata.name]))},filteredRows(){return"none"===this.groupPreference?this.rows:this.rowsWithFakeNamespaces},rows(){let e;try{e=this.$store.getters["prefs/get"](x.ALL_NAMESPACES)}catch{e=this.$store.getters["prefs/get"](x.DEV)}return e?this.activeNamespaces:this.activeNamespaces.filter((e=>{const t=this.$store.getters["systemNamespaces"].includes(e.metadata.name),r=e.isSystem||e.isFleetManaged||t;return!this.currentProduct?.hideSystemResources||!r}))},canSeeProjectlessNamespaces(){return this.currentCluster.canUpdate},showMockNotInProjectGroup(){if(!this.canSeeProjectlessNamespaces)return!1;const e=!this.rows.some((e=>!e.project)),t=this.userIsFilteringForSpecificNamespaceOrProject();return!t&&e},notInProjectKey(){return this.$store.getters["i18n/t"]("resourceTable.groupLabel.notInAProject")},showCreateNsButton(){return"namespace"!==this.groupPreference}},methods:{getPsaTooltip(e){const t=e.psaTooltipsDescription,r=Object.values(t).sort().map((e=>`<li>${e}</li>`)).join(""),s=`<p>${this.t("podSecurityAdmission.name")}: </p>`;return`${s}<ul class="psa-tooltip">${r}</ul>`},userIsFilteringForSpecificNamespaceOrProject(){const e=this.$store.getters["namespaceFilters"];for(let t=0;t<e.length;t++){const r=e[t],s=r.split("://")[0];if("ns"===s||"project"===s)return!0}return!1},slotName(e){return`main-row:${e.id}`},createNamespaceLocation(e){const t=e.rows[0].project,r=this.createNamespaceLocationOverride?{...this.createNamespaceLocationOverride}:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:C.CU}};return r.query={[S.iJ]:t?.metadata.name},r},createNamespaceLocationFlatList(){const e=this.createNamespaceLocationOverride?{...this.createNamespaceLocationOverride}:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"]?.name,resource:C.CU}};return e.query={[S._N]:!0},e},showProjectAction(e,t){const r=t.rows[0].project;this.$store.commit("action-menu/show",{resources:[r],elem:e.target})},showProjectActionButton(e){const t=e.rows[0].project;return!!t},projectLabel(e){const t=e.rows[0];return t.isFake?I().sanitize(this.t("resourceTable.groupLabel.project",{name:t.project?.nameDisplay},!0),{ALLOWED_TAGS:["span"]}):t.groupByLabel},projectDescription(e){const t=e.rows[0].project;return t?.description},projectResource(e){const t=e.rows[0];return t.nameDisplay||t.id||""},clearSelection(){this.$refs.table.clearSelection()},sortGenerationFn(){const e=(0,w.S)(this.schema,this.$store);return e+(this.showMockNotInProjectGroup?"-mock":"")}}};r(56452),r(2314);var U=r(66262);const D=(0,U.A)(W,[["render",P],["__scopeId","data-v-623c683a"]]),X=D,B={components:{ExplorerProjectsNamespaces:X}},G=(0,U.A)(B,[["render",o]]),Q=G},74346:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(31601),a=r.n(s),o=r(76314),c=r.n(o),n=r(5111),i=c()(a());i.i(n.A),i.push([e.id,".project-namespaces[data-v-623c683a]  .project-namespaces-table table{table-layout:fixed}.project-namespaces[data-v-623c683a]  .project-name{line-height:30px}.project-namespaces[data-v-623c683a]  .project-bar{display:flex;flex-direction:row;justify-content:space-between}.project-namespaces[data-v-623c683a]  .project-bar .group-tab{max-width:calc(100% - 230px)}.project-namespaces[data-v-623c683a]  .project-bar .project-name{display:flex;flex-direction:row;align-items:center}.project-namespaces[data-v-623c683a]  .project-bar .project-name span:first-child{padding-right:8px}.project-namespaces[data-v-623c683a]  .project-bar .project-name span:last-child{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.project-namespaces[data-v-623c683a]  .project-bar.has-description .right{margin-top:5px}.project-namespaces[data-v-623c683a]  .project-bar.has-description .group-tab,.project-namespaces[data-v-623c683a]  .project-bar.has-description .group-tab:after{height:50px}.project-namespaces[data-v-623c683a]  .project-bar.has-description .group-tab:after{right:-20px}.project-namespaces[data-v-623c683a]  .project-bar.has-description .group-tab .description{margin-top:-20px}.project-namespaces[data-v-623c683a]  .namespace-name{display:flex;align-items:center}.project-namespaces[data-v-623c683a]  .namespace-name .icon-istio{color:var(--primary)}",""]);const p=i},57308:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(31601),a=r.n(s),o=r(76314),c=r.n(o),n=r(5111),i=c()(a());i.i(n.A),i.push([e.id,".psa-tooltip{margin:3px 0;padding:0 8px 0 22px}",""]);const p=i},56452:(e,t,r)=>{var s=r(74346);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=r(99548).A;a("70ecba76",s,!0,{sourceMap:!1,shadowMode:!1})},2314:(e,t,r)=>{var s=r(57308);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=r(99548).A;a("3a156631",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=6226.468acdcf.js.map