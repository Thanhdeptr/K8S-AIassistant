(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[5233,5614],{26527:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var o=s(20641),a=s(90033);const l={class:"text-default-text"},n={class:"pl-10 pr-10",style:{"min-height":"50px",display:"flex"}},i={class:"bottom"},r={class:"buttons"};function c(e,t,s,c,d,p){const u=(0,o.g2)("Banner"),h=(0,o.g2)("AsyncButton"),m=(0,o.g2)("Card"),y=(0,o.gN)("clean-html");return(0,o.uX)(),(0,o.Wv)(m,{class:"prompt-restore","show-highlight-border":!1},{title:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"title",{},(()=>[(0,o.bo)((0,o.Lk)("h4",l,null,512),[[y,s.title]])]),!0)])),body:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"body",{},(()=>[(0,o.bo)((0,o.Lk)("div",n,null,512),[[y,p.decodeHtml(s.body)]])]),!0)])),actions:(0,o.k6)((()=>[(0,o.Lk)("div",i,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(d.errors,((e,t)=>((0,o.uX)(),(0,o.Wv)(u,{key:t,color:"error",label:e},null,8,["label"])))),128)),t[2]||(t[2]=(0,o.eW)()),(0,o.Lk)("div",r,[(0,o.Lk)("button",{class:"btn role-secondary mr-10",onClick:t[0]||(t[0]=(...e)=>p.close&&p.close(...e))},(0,a.v_)(e.t("generic.cancel")),1),t[1]||(t[1]=(0,o.eW)()),(0,o.bF)(h,{mode:s.applyMode,onClick:p.apply},null,8,["mode","onClick"])])])])),_:3,__:[3,4]})}var d=s(97671),p=s(75672),u=s(14492),h=s(37447),m=s(72140),y=s(96763);const f={emits:["close"],components:{Card:p.Z,AsyncButton:d.A,Banner:u.l},props:{applyAction:{type:Function,default:()=>{}},applyMode:{type:String,default:"create"},title:{type:String,default:""},body:{type:String,default:""},confirm:{type:Function,default:()=>{}}},data(){return{errors:[]}},methods:{decodeHtml:m.iT,close(){this.confirm(!1),this.$emit("close",!1)},async apply(e){try{await this.applyAction(e),this.confirm(!0),this.$emit("close",!0)}catch(t){y.error(t),this.errors=(0,h.rz)(t),e(!1)}}}};s(44308);var v=s(66262);const g=(0,v.A)(f,[["render",c],["__scopeId","data-v-226176ac"]]),b=g},31818:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var o=s(20641),a=s(90033);const l={class:"pl-10 pr-10 mt-20 mb-20 body"},n={key:0},i={key:1},r={key:2,class:"retained-machine"},c={class:"mb-20"};function d(e,t,s,d,p,u){const h=(0,o.g2)("GenericPrompt"),m=(0,o.gN)("clean-html");return(0,o.uX)(),(0,o.Wv)(h,(0,o.v6)(p.config,{onClose:t[0]||(t[0]=t=>e.$emit("close"))}),{body:(0,o.k6)((()=>[(0,o.Lk)("div",l,[1===p.allToDelete.length?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.eW)((0,a.v_)(e.t("promptRemove.attemptingToRemove",{type:p.type}))+" ",1),(0,o.Lk)("b",null,(0,a.v_)(p.safeMachinesToDelete[0].nameDisplay),1)])):((0,o.uX)(),(0,o.CE)("div",i,(0,a.v_)(e.t("promptScaleMachineDown.attemptingToRemove",{type:p.type,count:p.allToDelete.length},!0)),1)),t[2]||(t[2]=(0,o.eW)()),p.ignored.length?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("span",c,(0,a.v_)(e.t("promptScaleMachineDown.retainedMachine1")),1),t[1]||(t[1]=(0,o.eW)()),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.ignored,(t=>(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",{key:t})),[[m,e.t("promptScaleMachineDown.retainedMachine2",{name:t.nameDisplay},!0)]]))),128))])):(0,o.Q3)("",!0)])])),_:1},16)}var p=s(96676),u=s(55823),h=s(26527);const m={emits:["close"],components:{GenericPrompt:h["default"]},props:{resources:{type:Array,required:!0}},async fetch(){this.isRke2?await Promise.all([this.$store.dispatch("management/findAll",{type:u.qt.MACHINE_DEPLOYMENT}),this.$store.dispatch("management/findAll",{type:u.qt.MACHINE})]):await Promise.all([this.$store.dispatch("management/findAll",{type:u.Mc.NODE_POOL}),this.$store.dispatch("management/findAll",{type:u.Mc.NODE})])},data(){const e=this.resources[0].cluster?.isRke2,t=e?this.resources[0].cluster:this.resources[0].provisioningCluster,[s,o]=this.deleteType("isControlPlane",this.resources,t,e),[a,l]=this.deleteType("isEtcd",o,t,e),n=[s,a].filter((e=>!!e));return{cluster:t,isRke2:e,allToDelete:this.resources,safeMachinesToDelete:l,ignored:n,type:this.$store.getters["type-map/labelFor"](this.resources[0].schema,this.resources.length),config:{title:this.t("promptRemove.title"),applyMode:"delete",applyAction:this.remove}}},methods:{deleteType(e,t,s,o){const a=t.reduce(((t,s)=>(s[e]?t.typed.push(s):t.others.push(s),t)),{typed:[],others:[]}),l=o?s.machines:s.nodes,n=l.filter((t=>t[e])).length,i=a.typed.length,r=n-i===0?a.typed.pop():void 0,c=[...a.typed,...a.others];return[r,c]},async remove(){if(!this.isRke2)return void await Promise.all(this.safeMachinesToDelete.map((e=>e.norman?.doAction("scaledown"))));const e=this.safeMachinesToDelete.reduce(((e,t)=>(e.set(t.pool,e.get(t.pool)||[]),e.get(t.pool).push(t),e)),new Map),t=Array.from(e.entries());await Promise.all(t.map((([e,t])=>Promise.all(t.map((e=>(e.setAnnotation(p.qt.DELETE_MACHINE,"true"),e.save())))).then((()=>e.scalePool(-t.length,!1)))))),await this.cluster.save()}}};s(66229);var y=s(66262);const f=(0,y.A)(m,[["render",d],["__scopeId","data-v-1d8080b6"]]),v=f},44334:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var o=s(31601),a=s.n(o),l=s(76314),n=s.n(l),i=s(5111),r=n()(a());r.i(i.A),r.push([e.id,".prompt-restore[data-v-226176ac]{margin:0}.bottom[data-v-226176ac]{display:flex;flex-direction:column;flex:1}.bottom .banner[data-v-226176ac]{margin-top:0}.bottom .buttons[data-v-226176ac]{display:flex;justify-content:flex-end;width:100%}",""]);const c=r},69215:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var o=s(31601),a=s.n(o),l=s(76314),n=s.n(l),i=s(5111),r=n()(a());r.i(i.A),r.push([e.id,".body div[data-v-1d8080b6]:not(:last-of-type){padding-bottom:15px}.body .retained-machine[data-v-1d8080b6]{display:flex;flex-direction:column}",""]);const c=r},44308:(e,t,s)=>{var o=s(44334);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("7cc2cf07",o,!0,{sourceMap:!1,shadowMode:!1})},66229:(e,t,s)=>{var o=s(69215);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("066072ce",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=dialog28.4117069f.js.map