(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[7499],{37499:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var n=i(20641),s=i(90033),o=i(53751);const a={class:"card-actions"};function r(t,e,i,r,c,l){const d=(0,n.g2)("Banner"),u=(0,n.g2)("PercentageBar"),h=(0,n.g2)("t"),v=(0,n.g2)("ModalWithCard");return c.isOpen?((0,n.uX)(),(0,n.Wv)(v,{key:0,ref:"inactivityModal",name:"inactivityModal","save-text":"Continue",onFinish:l.resume},{title:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(l.isInactiveTexts.title),1)])),content:(0,n.k6)((()=>[(0,n.bF)(d,{color:"info"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(l.isInactiveTexts.banner),1)])),_:1}),e[2]||(e[2]=(0,n.eW)()),(0,n.Lk)("p",null,(0,s.v_)(l.isInactiveTexts.content),1),e[3]||(e[3]=(0,n.eW)()),c.isInactive?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(u,{key:0,class:"mt-20",modelValue:l.timerPercentageLeft,"color-stops":l.colorStops},null,8,["modelValue","color-stops"]))])),footer:(0,n.k6)((()=>[(0,n.Lk)("div",a,[c.isInactive?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn role-tertiary bg-primary",onClick:e[0]||(e[0]=(0,o.D$)(((...t)=>l.resume&&l.resume(...t)),["prevent"]))},[(0,n.bF)(h,{k:"inactivity.cta"})])),e[4]||(e[4]=(0,n.eW)()),c.isInactive?((0,n.uX)(),(0,n.CE)("button",{key:1,class:"btn role-tertiary bg-primary",onClick:e[1]||(e[1]=(0,o.D$)(((...t)=>l.refresh&&l.refresh(...t)),["prevent"]))},[(0,n.bF)(h,{k:"inactivity.ctaExpired"})])):(0,n.Q3)("",!0)])])),default:(0,n.k6)((()=>[e[5]||(e[5]=(0,n.eW)()),(0,n.Lk)("span",null,(0,s.v_)(c.courtesyCountdown),1),e[6]||(e[6]=(0,n.eW)()),e[7]||(e[7]=(0,n.eW)())])),_:1,__:[5,6,7]},8,["onFinish"])):(0,n.Q3)("",!0)}const c={class:"text-default-text"},l={class:"footer"};function d(t,e,i,a,r,d){const u=(0,n.g2)("Banner"),h=(0,n.g2)("AsyncButton"),v=(0,n.g2)("Card"),m=(0,n.g2)("app-modal");return(0,n.uX)(),(0,n.Wv)(m,(0,n.v6)({name:i.name,width:i.width,"click-to-close":!1,height:i.height},t.$attrs,{class:"modal","data-testid":"mvc__card",onClose:e[2]||(e[2]=e=>t.$emit("finish",e))}),{default:(0,n.k6)((()=>[(0,n.bF)(v,{class:"modal","show-highlight-border":!1},{title:(0,n.k6)((()=>[(0,n.Lk)("h4",c,[(0,n.RG)(t.$slots,"title",{},void 0,!0)])])),body:(0,n.k6)((()=>[(0,n.RG)(t.$slots,"content",{},void 0,!0),e[3]||(e[3]=(0,n.eW)()),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.errors,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{key:e},[(0,n.bF)(u,{class:"banner",color:"error",label:t},null,8,["label"])])))),128))])),actions:(0,n.k6)((()=>[(0,n.RG)(t.$slots,"footer",{},(()=>[(0,n.Lk)("div",l,[(0,n.Lk)("button",{class:"btn role-secondary mr-20",onClick:e[0]||(e[0]=(0,o.D$)(((...t)=>d.hide&&d.hide(...t)),["prevent"]))},(0,s.v_)(i.closeText),1),e[4]||(e[4]=(0,n.eW)()),(0,n.bF)(h,{mode:i.saveText,onClick:e[1]||(e[1]=e=>t.$emit("finish",e))},null,8,["mode"])])]),!0)])),_:3,__:[5,6]})])),_:3},16,["name","width","height"])}var u=i(75672),h=i(14492),v=i(97671),m=i(53818);const y={name:"ModalWithCard",emits:["close","finish"],components:{Card:u.Z,Banner:h.l,AsyncButton:v.A,AppModal:m.h},props:{name:{type:String,required:!0},closeText:{type:String,default:"Close"},saveText:{type:String,default:"create"},width:{type:[String,Number],default:"50%"},height:{type:[String,Number],default:"auto"},errors:{type:Array,default:()=>[]}},methods:{hide(){this.$emit("close")}}};i(5560),i(8982);var f=i(66262);const p=(0,f.A)(y,[["render",d],["__scopeId","data-v-0430f766"]]),b=p;var k=i(48620),I=i(7350),w=i.n(I),g=i(55823),T=i(95822),_=i(96763);let C;const A={name:"Inactivity",components:{ModalWithCard:b,Banner:h.l,PercentageBar:k.A},data(){return{enabled:null,isOpen:!1,isInactive:!1,showModalAfter:null,inactivityTimeoutId:null,courtesyTimer:null,courtesyTimerId:null,courtesyCountdown:null,trackInactivity:w()(this._trackInactivity,1e3),id:null}},async mounted(){let t;try{const e=await this.$store.dispatch("management/find",{type:g.Mc.SETTING,id:T.HG.UI_PERFORMANCE});t=e?.value?JSON.parse(e.value):T.$8}catch{}if(!t||!t?.inactivity||!t?.inactivity.enabled)return;this.enabled=t?.inactivity?.enabled||!1;const e=60*t?.inactivity?.threshold;this.courtesyTimer=Math.floor(.1*e),this.courtesyTimer=Math.min(this.courtesyTimer,300),this.showModalAfter=e-this.courtesyTimer,_.debug(`Inactivity modal will show after ${this.showModalAfter/60}(m) and be shown for ${this.courtesyTimer/60}(m)`),this.courtesyCountdown=this.courtesyTimer,t?.inactivity.enabled&&(this.trackInactivity(),this.addIdleListeners())},beforeUnmount(){this.removeEventListener(),this.clearAllTimeouts()},methods:{_trackInactivity(){if(this.isInactive||this.isOpen||!this.showModalAfter)return;this.clearAllTimeouts();const t=Date.now()+1e3*this.showModalAfter;this.id=t,C=t;const e=()=>{const i=Date.now();this.id===C&&(i>=t?(this.isOpen=!0,this.startCountdown()):this.inactivityTimeoutId=setTimeout(e,1e3))};e()},startCountdown(){const t=Date.now()+1e3*this.courtesyCountdown,e=()=>{const i=Date.now();i>=t?(this.isInactive=!0,this.unsubscribe(),this.clearAllTimeouts()):(this.courtesyCountdown=Math.floor((t-i)/1e3),this.courtesyTimerId=setTimeout(e,1e3))};e()},addIdleListeners(){document.addEventListener("mousemove",this.trackInactivity),document.addEventListener("mousedown",this.trackInactivity),document.addEventListener("keypress",this.trackInactivity),document.addEventListener("touchmove",this.trackInactivity),document.addEventListener("visibilitychange",this.trackInactivity)},removeEventListener(){document.removeEventListener("mousemove",this.trackInactivity),document.removeEventListener("mousedown",this.trackInactivity),document.removeEventListener("keypress",this.trackInactivity),document.removeEventListener("touchmove",this.trackInactivity),document.removeEventListener("visibilitychange",this.trackInactivity)},resume(){this.isInactive=!1,this.isOpen=!1,this.courtesyCountdown=this.courtesyTimer,this.clearAllTimeouts()},refresh(){window.location.reload()},unsubscribe(){_.debug("Unsubscribing from all websocket events"),this.$store.dispatch("unsubscribe")},clearAllTimeouts(){clearTimeout(this.inactivityTimeoutId),clearTimeout(this.courtesyTimerId)}},computed:{isInactiveTexts(){return this.isInactive?{title:this.t("inactivity.titleExpired"),banner:this.t("inactivity.bannerExpired"),content:this.t("inactivity.contentExpired")}:{title:this.t("inactivity.title"),banner:this.t("inactivity.banner"),content:this.t("inactivity.content")}},timerPercentageLeft(){return Math.floor(this.courtesyCountdown/this.courtesyTimer*100)},colorStops(){return{0:"--info",30:"--info",70:"--info"}}}};i(63297);const M=(0,f.A)(A,[["render",r],["__scopeId","data-v-400e8fa5"]]),x=M},75676:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>l});var n=i(31601),s=i.n(n),o=i(76314),a=i.n(o),r=i(5111),c=a()(s());c.i(r.A),c.push([t.id,".card-actions[data-v-400e8fa5]{display:flex;width:100%;justify-content:flex-end}",""]);const l=c},41830:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>l});var n=i(31601),s=i.n(n),o=i(76314),a=i.n(o),r=i(5111),c=a()(s());c.i(r.A),c.push([t.id,".footer[data-v-0430f766]{width:100%;display:flex;justify-content:center}.banner[data-v-0430f766]{margin-bottom:0}",""]);const l=c},82760:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>l});var n=i(31601),s=i.n(n),o=i(76314),a=i.n(o),r=i(5111),c=a()(s());c.i(r.A),c.push([t.id,".modal{border-radius:var(--border-radius);max-height:100vh}.modal.card-container{box-shadow:none}",""]);const l=c},63297:(t,e,i)=>{var n=i(75676);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);var s=i(99548).A;s("107f529c",n,!0,{sourceMap:!1,shadowMode:!1})},5560:(t,e,i)=>{var n=i(41830);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);var s=i(99548).A;s("22713baf",n,!0,{sourceMap:!1,shadowMode:!1})},8982:(t,e,i)=>{var n=i(82760);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);var s=i(99548).A;s("8321de7a",n,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=7499.790d1c5a.js.map