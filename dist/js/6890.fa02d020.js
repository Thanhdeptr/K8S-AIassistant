"use strict";(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[6890],{86890:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var o=r(20641);const i={class:"main-layout"},s={class:"text-center mt-50"},n={key:0},u={key:1},a={key:2};function l(e,t,r,l,c,h){return(0,o.uX)(),(0,o.CE)("main",i,[(0,o.Lk)("h1",s,[c.testing?((0,o.uX)(),(0,o.CE)("span",n,"\n        Testing Configuration…\n      ")):c.isSlo?((0,o.uX)(),(0,o.CE)("span",u,"\n        Logging Out…\n      ")):((0,o.uX)(),(0,o.CE)("span",a,"\n        Logging In…\n      "))])])}var c=r(46405),h=r(6826),p=r(91709),g=r(51229),$=r(82943),d=r(96763);const w=["ping","adfs","keycloak","okta","shibboleth"],f=["github","googleoauth","azuread"];function y(e,t){try{window.opener.window.onAuthTest(e,t),setTimeout((()=>{window.close()}),250)}catch(r){window.close()}}function k(e){const{query:t}=e,r=(0,h.get)(t,"config");return w.includes(r)}const v={async fetch(){const e=this.$route.query[c.Wt],t=this.$route.query[c.Mg],{error:r,error_description:o,errorCode:i,errorMsg:s}=this.$route.query;if(r||o||i||s){let e=o||r||i;if(this.isSlo){d.error("Failed to log out of auth provider",r,o,i,s);let e=this.$store.getters["i18n/withFallback"]("logout.specificError.unknown");return i&&(e=this.$store.getters["i18n/withFallback"](`logout.specificError.${i}`,null,e)),void this.$router.replace(`/auth/login?${c.kM}&err=${escape(e)}`)}return s&&(e=this.$store.getters["i18n/withFallback"](`login.serverError.${s}`,null,s)),void this.$router.replace(`/auth/login?err=${escape(e)}`)}if(this.isSlo)return void this.$store.dispatch("auth/uiLogout");let n;try{n=JSON.parse((0,p.u)(t))}catch(h){if(k(this.$route))return;const e=this.$store.getters["i18n/t"]("login.error");return d.error("Failed to parse nonce",t,h),void this.$router.replace(`/auth/login?err=${escape(e)}`)}const{test:u,provider:a,nonce:l}=n;if(!u)try{const t=await this.$store.dispatch("auth/verifyOAuth",{code:e,nonce:l,provider:a});if(200===t._status){const e=this.$route.query[c.MW]||"/";await(0,g.A)({app:this.$store.app,store:this.$store,$plugin:this.$store.$plugin}),this.$router.replace(e)}else this.$router.replace(`/auth/login?err=${escape(t)}`)}catch(h){let e=h;f.includes(a)&&h===$.LOGIN_ERRORS.CLIENT_UNAUTHORIZED&&(e=$.LOGIN_ERRORS.USER_UNAUTHORIZED),this.$router.replace(`/auth/login?err=${escape(e)}`)}},data(){const e=this.$route.query[c.Mg]||"";let t={};try{t=JSON.parse((0,p.u)(e))}catch{}const{test:r}=t,o=this.$route.query[c.kM]===c.Qp;return{testing:r,isSlo:o}},mounted(){if(this.testing)try{const{error:e,error_description:t,[c.Wt]:r,errorMsg:o}=this.$route.query;let i=t||e||(r?null:"No code supplied by auth provider");o&&(i=this.$store.getters["i18n/withFallback"](`login.serverError.${o}`,null,o)),y(i,r)}catch(e){window.close()}else window.opener&&k(this.$route)&&(window.opener.window.onAuthTest?y(null,null):y({err:"failure"}))}};var E=r(66262);const _=(0,E.A)(v,[["render",l]]),b=_}}]);
//# sourceMappingURL=6890.fa02d020.js.map