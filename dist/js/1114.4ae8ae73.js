(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[1114],{41114:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var i=t(20641),o=t(90033);const a={class:"header"},n={class:"title"},s={class:"primaryheader"},c={class:"actions-container"},l={class:"actions"};function u(e,r,t,u,m,g){const d=(0,i.g2)("ButtonGroup"),h=(0,i.g2)("ResourceYaml"),v=(0,i.g2)("ReceiverConfig"),f=(0,i.g2)("ActionMenu");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("header",a,[(0,i.Lk)("div",n,[(0,i.Lk)("div",s,[(0,i.Lk)("h1",null,(0,o.v_)(g.heading),1)])]),r[5]||(r[5]=(0,i.eW)()),(0,i.Lk)("div",c,[(0,i.Lk)("div",l,[m.viewOptions&&g.mode===m.view?((0,i.uX)(),(0,i.Wv)(d,{key:0,value:g.currentView,options:m.viewOptions,"onUpdate:value":g.handleButtonGroupClick},null,8,["value","options","onUpdate:value"])):(0,i.Q3)("",!0),r[4]||(r[4]=(0,i.eW)()),g.mode===m.view?((0,i.uX)(),(0,i.CE)("button",{key:1,ref:"actions","aria-haspopup":"true",type:"button",class:"btn role-multi-action actions",onClick:r[0]||(r[0]=(...e)=>g.handleReceiverActionMenuClick&&g.handleReceiverActionMenuClick(...e))},r[3]||(r[3]=[(0,i.Lk)("i",{class:"icon icon-actions"},null,-1)]),512)):(0,i.Q3)("",!0)])])]),r[6]||(r[6]=(0,i.eW)()),g.currentView===m.yaml&&m.alertmanagerConfigResource?((0,i.uX)(),(0,i.Wv)(h,{key:0,ref:"resourceyaml",value:m.alertmanagerConfigResource,mode:g.mode,"initial-yaml-for-diff":null,yaml:g.resourceYaml,"offer-preview":g.mode===m.edit,"done-route":JSON.stringify(g.redirectToReceiverDetail(m.receiverName)),"done-override":m.alertmanagerConfigDetailRoute,"apply-hooks":m.alertmanagerConfigResource.applyHooks,onError:r[1]||(r[1]=r=>e.$emit("error",r))},null,8,["value","mode","yaml","offer-preview","done-route","done-override","apply-hooks"])):(0,i.Q3)("",!0),r[7]||(r[7]=(0,i.eW)()),g.currentView!==m.config&&g.currentView!==m.detail||!m.alertmanagerConfigResource?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(v,{key:1,ref:"config",value:m.receiverValue,mode:g.mode,"alertmanager-config-id":m.alertmanagerConfigId,"alertmanager-config-resource":m.alertmanagerConfigResource,"save-override":g.saveOverride},null,8,["value","mode","alertmanager-config-id","alertmanager-config-resource","save-override"])),r[8]||(r[8]=(0,i.eW)()),(0,i.bF)(f,{"custom-actions":g.receiverActions,open:m.receiverActionMenuIsOpen,"use-custom-target-element":!0,"custom-target-element":m.actionMenuTargetElement,"custom-target-event":m.actionMenuTargetEvent,onClose:r[2]||(r[2]=e=>m.receiverActionMenuIsOpen=!1),onGoToEdit:g.goToEdit,onGoToEditYaml:g.goToEditYaml,onPromptRemove:g.promptRemove},null,8,["custom-actions","open","custom-target-element","custom-target-event","onGoToEdit","onGoToEditYaml","onPromptRemove"])])}var m=t(86311),g=t(55590),d=t(64594),h=t(33343),v=t(57561),f=t(44996),p=t(55823),C=t(46405),R=t(6826);const y={name:"AlertmanagerConfigReceiverCreateEdit",emits:["error"],components:{ActionMenu:m.A,ButtonGroup:d.A,ReceiverConfig:g["default"],ResourceYaml:h.A},async fetch(){const e=this.$store.getters["currentProduct"].inStore,r=this.$store.getters[`${e}/schemaFor`](p.Rp.ALERTMANAGERCONFIG);this.receiverName=this.$route.query.receiverName;const t=this.$route.params.alertmanagerconfigid,i=await this.$store.dispatch(`${e}/find`,{type:p.Rp.ALERTMANAGERCONFIG,id:t}),o=await this.$store.dispatch(`${e}/clone`,{resource:i});await r.fetchResourceFields();const a=this.$route.query.mode;if(a!==C.YQ){const e=(o.spec.receivers||[]).find((e=>e.name===this.receiverName));e&&(this.receiverValue=e)}this.alertmanagerConfigId=o.id,this.alertmanagerConfigResource=o,this.alertmanagerConfigDetailRoute=o._detailLocation},data(){return{actionMenuTargetElement:null,actionMenuTargetEvent:null,alertmanagerConfigId:"",alertmanagerConfigResource:null,alertmanagerConfigDetailRoute:null,config:C.au,create:C.YQ,detail:C.fS,edit:C.G5,receiverActionMenuIsOpen:!1,receiverName:"",receiverValue:{},showPreview:!1,view:C.nW,viewOptions:[{labelKey:"resourceDetail.masthead.config",value:"config"},{labelKey:"resourceDetail.masthead.yaml",value:C.zD}],yaml:C.zD}},computed:{currentView(){return this.$route.query.currentView},receiverActions(){const e=this.alertmanagerConfigResource?.availableActions;return e?this.alertmanagerConfigResource.getReceiverActions(e):[]},resourceYaml(){const e=this.alertmanagerConfigResource,r=this.$store.getters["currentStore"](e),t=this.$store.getters[`${r}/all`](p.yx),i=(0,R.clone)(e),o=(0,v.mH)(t,p.Rp.ALERTMANAGERCONFIG,i);return o},mode(){return this.$route.query.mode},editorMode(){return this.mode===this.view?f.j.VIEW_CODE:this.showPreview?f.j.DIFF_CODE:f.j.EDIT_CODE},heading(){switch(this.$route.query.mode){case this.create:return this.t("monitoring.alertmanagerConfig.receiverFormNames.create");case this.edit:return this.currentView===this.yaml||this.$route.query.as===this.yaml?this.t("monitoring.alertmanagerConfig.receiverFormNames.editYaml"):this.t("monitoring.alertmanagerConfig.receiverFormNames.edit");default:return this.t("monitoring.alertmanagerConfig.receiverFormNames.detail")}}},methods:{async saveOverride(e){if(this.alertmanagerConfigResource.yamlError)return this.alertmanagerConfigResource.errors=this.alertmanagerConfigResource.errors||[],this.alertmanagerConfigResource.errors.push(this.alertmanagerConfigResource.yamlError),void e(!1);try{await this.alertmanagerConfigResource.save(...arguments),e(!0),this.redirectToAlertmanagerConfigDetail()}catch(r){const t=r?.message?r.message:this.t("monitoring.alertmanagerConfig.error");this.$refs.config.setError(t),e(!1)}},handleButtonGroupClick(e){e===this.yaml&&this.goToEditYaml(this.view),e===this.config&&this.goToEdit(this.view)},toggleReceiverActionMenu(){this.receiverActionMenuIsOpen=!this.receiverActionMenuIsOpen},handleReceiverActionMenuClick(e){this.actionMenuTargetElement=this.$refs.actions,this.actionMenuTargetEvent=e,this.toggleReceiverActionMenu()},goToEdit(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverConfigRoute(this.receiverValue.name,C.G5))},goToEditYaml(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverYamlRoute(this.receiverValue.name,C.G5))},promptRemove(e){const r=e.route.query.receiverName,t=this.alertmanagerConfigResource.spec.receivers||[],i=t.filter((e=>e.name!==r));this.alertmanagerConfigResource.spec.receivers=i,this.alertmanagerConfigResource.save(...arguments),this.$router.push(this.alertmanagerConfigResource._detailLocation)},redirectToReceiverDetail(e){return this.alertmanagerConfigResource.getReceiverDetailLink(e)},redirectToAlertmanagerConfigDetail(){const e=this.alertmanagerConfigResource._detailLocation;this.$router.push(e)}}};t(30959);var E=t(66262);const A=(0,E.A)(y,[["render",u],["__scopeId","data-v-bbeb3a8e"]]),w=A},4329:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var i=t(31601),o=t.n(i),a=t(76314),n=t.n(a),s=t(5111),c=n()(o());c.i(s.A),c.push([e.id,".header[data-v-bbeb3a8e]{border-bottom:1px solid var(--border);margin-bottom:0;padding-bottom:20px}.header H1[data-v-bbeb3a8e]{flex:1}",""]);const l=c},30959:(e,r,t)=>{var i=t(4329);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var o=t(99548).A;o("775e80c5",i,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=1114.4ae8ae73.js.map