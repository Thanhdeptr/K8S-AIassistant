{"version":3,"file":"js/9384.8c576085.js","mappings":"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","sources":["webpack://ui-plugin-examples/./node_modules/@rancher/shell/pages/c/_cluster/auth/roles/index.vue","webpack://ui-plugin-examples/./node_modules/@rancher/shell/pages/c/_cluster/auth/roles/index.vue?12fe"],"sourcesContent":["<script>\nimport Tab from '@shell/components/Tabbed/Tab';\nimport Tabbed from '@shell/components/Tabbed';\nimport { MANAGEMENT } from '@shell/config/types';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Loading from '@shell/components/Loading';\nimport { SUBTYPE_MAPPING, CREATE_VERBS } from '@shell/models/management.cattle.io.roletemplate';\nimport { NAME } from '@shell/config/product/auth';\nimport { BLANK_CLUSTER } from '@shell/store/store-types.js';\n\nconst GLOBAL = SUBTYPE_MAPPING.GLOBAL.key;\nconst CLUSTER = SUBTYPE_MAPPING.CLUSTER.key;\nconst PROJECT = SUBTYPE_MAPPING.NAMESPACE.key;\n\nconst createGlobalRole = {\n  name:   `c-cluster-${ NAME }-roles-resource-create`,\n  params: {\n    cluster:  BLANK_CLUSTER,\n    resource: MANAGEMENT.GLOBAL_ROLE,\n  }\n};\nconst createRoleTemplate = {\n  name:   `c-cluster-${ NAME }-roles-resource-create`,\n  params: {\n    cluster:  BLANK_CLUSTER,\n    resource: MANAGEMENT.ROLE_TEMPLATE,\n  }\n};\n\nexport default {\n  name: 'Roles',\n\n  components: {\n    Tab, Tabbed, ResourceTable, Loading\n  },\n\n  async fetch() {\n    const globalRoleSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.GLOBAL_ROLE);\n    const roleTemplatesSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.ROLE_TEMPLATE);\n\n    this['globalRoles'] = globalRoleSchema ? await this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.GLOBAL_ROLE }) : [];\n    this['roleTemplates'] = roleTemplatesSchema ? await this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.ROLE_TEMPLATE }) : [];\n  },\n\n  data() {\n    const globalRoleSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.GLOBAL_ROLE);\n    const roleTemplatesSchema = this.$store.getters[`management/schemaFor`](MANAGEMENT.ROLE_TEMPLATE);\n\n    const roleTemplateHeaders = this.$store.getters['type-map/headersFor'](roleTemplatesSchema);\n    const defaultHeaderIndex = roleTemplateHeaders.findIndex((header) => header.name === 'default');\n\n    return {\n      tabs: {\n        [GLOBAL]: {\n          canFetch:       globalRoleSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      globalRoleSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          weight:         3,\n          labelKey:       SUBTYPE_MAPPING.GLOBAL.labelKey,\n          schema:         globalRoleSchema,\n          createLocation: {\n            ...createGlobalRole,\n            query: { roleContext: GLOBAL }\n          },\n        },\n        [CLUSTER]: {\n          canFetch:       roleTemplatesSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      roleTemplatesSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          labelKey:       SUBTYPE_MAPPING.CLUSTER.labelKey,\n          weight:         2,\n          schema:         roleTemplatesSchema,\n          headers:        this.applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, 'tableHeaders.authRoles.clusterDefault'),\n          createLocation: {\n            ...createRoleTemplate,\n            query: { roleContext: CLUSTER }\n          },\n        },\n        [PROJECT]: {\n          canFetch:       roleTemplatesSchema?.collectionMethods.find((verb) => verb === 'GET'),\n          canCreate:      roleTemplatesSchema?.resourceMethods.find((verb) => CREATE_VERBS.has(verb)),\n          labelKey:       SUBTYPE_MAPPING.NAMESPACE.labelKey,\n          weight:         1,\n          schema:         roleTemplatesSchema,\n          headers:        this.applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, 'tableHeaders.authRoles.projectDefault'),\n          createLocation: {\n            ...createRoleTemplate,\n            query: { roleContext: PROJECT }\n          },\n        },\n      },\n\n      GLOBAL,\n      CLUSTER,\n      PROJECT,\n\n      globalRoles:   null,\n      roleTemplates: null,\n    };\n  },\n\n  computed: {\n    globalResources() {\n      return this.globalRoles;\n    },\n\n    clusterResources() {\n      return this.roleTemplates.filter((r) => r.context === SUBTYPE_MAPPING.CLUSTER.context);\n    },\n\n    namespaceResources() {\n      return this.roleTemplates.filter((r) => r.context === SUBTYPE_MAPPING.NAMESPACE.context);\n    },\n\n    type() {\n      if (this.$route.hash.endsWith(PROJECT)) {\n        return PROJECT;\n      }\n      if (this.$route.hash.endsWith(CLUSTER)) {\n        return CLUSTER;\n      }\n\n      return GLOBAL;\n    },\n\n    canCreate() {\n      return this.tabs[this.type].canCreate;\n    },\n\n    createLabel() {\n      return this.t(`rbac.roletemplate.subtypes.${ this.type }.createButton`);\n    },\n\n    createLocation() {\n      return this.tabs[this.type].createLocation;\n    }\n\n  },\n\n  methods: {\n    applyDefaultHeaderLabel(roleTemplateHeaders, defaultHeaderIndex, labelKey) {\n      const headers = [...roleTemplateHeaders];\n\n      headers[defaultHeaderIndex] = {\n        ...roleTemplateHeaders[defaultHeaderIndex],\n        labelKey,\n      };\n\n      return headers;\n    }\n  }\n\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <header>\n      <div class=\"title\">\n        <h1 class=\"m-0\">\n          {{ t('auth.roleTemplate') }}\n        </h1>\n      </div>\n      <div class=\"actions-container\">\n        <div class=\"actions\">\n          <router-link\n            v-if=\"canCreate\"\n            :to=\"createLocation\"\n            class=\"btn role-primary\"\n          >\n            {{ createLabel }}\n          </router-link>\n        </div>\n      </div>\n    </header>\n    <Tabbed>\n      <Tab\n        v-if=\"tabs[GLOBAL].canFetch\"\n        :name=\"GLOBAL\"\n        :weight=\"tabs[GLOBAL].weight\"\n        :label-key=\"tabs[GLOBAL].labelKey\"\n      >\n        <ResourceTable\n          :schema=\"tabs[GLOBAL].schema\"\n          :rows=\"globalResources\"\n        />\n      </Tab>\n\n      <Tab\n        v-if=\"tabs[CLUSTER].canFetch\"\n        :name=\"CLUSTER\"\n        :weight=\"tabs[CLUSTER].weight\"\n        :label-key=\"tabs[CLUSTER].labelKey\"\n      >\n        <ResourceTable\n          :schema=\"tabs[CLUSTER].schema\"\n          :headers=\"tabs[CLUSTER].headers\"\n          :rows=\"clusterResources\"\n        />\n      </Tab>\n\n      <Tab\n        v-if=\"tabs[PROJECT].canFetch\"\n        :name=\"PROJECT\"\n        :weight=\"tabs[PROJECT].weight\"\n        :label-key=\"tabs[PROJECT].labelKey\"\n      >\n        <ResourceTable\n          :schema=\"tabs[PROJECT].schema\"\n          :headers=\"tabs[PROJECT].headers\"\n          :rows=\"namespaceResources\"\n        />\n      </Tab>\n    </Tabbed>\n  </div>\n</template>\n","import { render } from \"./index.vue?vue&type=template&id=506de01a\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","$fetchState","t","to","createLocation","createLabel","tabs","GLOBAL","name","weight","labelKey","schema","rows","globalResources","CLUSTER","headers","clusterResources","PROJECT","namespaceResources","SUBTYPE_MAPPING","key","NAMESPACE","createGlobalRole","NAME","params","cluster","resource","GLOBAL_ROLE","createRoleTemplate","ROLE_TEMPLATE","components","Tab","Tabbed","ResourceTable","Loading","fetch","globalRoleSchema","this","$store","getters","roleTemplatesSchema","dispatch","type","data","roleTemplateHeaders","defaultHeaderIndex","findIndex","header","canFetch","collectionMethods","find","verb","canCreate","resourceMethods","CREATE_VERBS","has","query","roleContext","applyDefaultHeaderLabel","globalRoles","roleTemplates","computed","filter","r","context","$route","hash","endsWith","methods","__exports__","render"],"sourceRoot":""}