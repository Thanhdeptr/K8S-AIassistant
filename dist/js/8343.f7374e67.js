(self["webpackChunkui_plugin_examples"]=self["webpackChunkui_plugin_examples"]||[]).push([[8343],{55446:(e,t,o)=>{"use strict";o.d(t,{A:()=>f});var s=o(20641),a=o(53751),l=o(90033);const i={key:0},r=["aria-label"],n={"data-testid":"locale-selector",class:"locale-chooser"},c={key:0,class:"icon icon-fw icon-sort-down"},d={class:"list-unstyled dropdown",style:{margin:"-1px"}},u=["lang","onClick","onKeyup"],g={key:1};function h(e,t,o,h,p,m){const v=(0,s.g2)("v-dropdown"),L=(0,s.g2)("Select"),b=(0,s.gN)("t");return(0,s.uX)(),(0,s.CE)("div",null,["login"===o.mode?((0,s.uX)(),(0,s.CE)("div",i,[m.showLocale?((0,s.uX)(),(0,s.CE)("div",{key:0,role:"menu","aria-label":e.t("locale.menu"),class:"locale-login-container",tabindex:"0",onClick:t[3]||(t[3]=(...e)=>m.openLocaleSelector&&m.openLocaleSelector(...e)),onBlurCapture:t[4]||(t[4]=(...e)=>m.closeLocaleSelector&&m.closeLocaleSelector(...e)),onKeyup:[t[5]||(t[5]=(0,a.jR)(((...e)=>m.openLocaleSelector&&m.openLocaleSelector(...e)),["enter"])),t[6]||(t[6]=(0,a.jR)(((...e)=>m.openLocaleSelector&&m.openLocaleSelector(...e)),["space"]))]},[(0,s.bF)(v,{popperClass:"localeSelector",shown:p.isLocaleSelectorOpen,placement:"top",distance:"8",skidding:"12",triggers:[],autoHide:!1,flip:!1,container:!1,onFocusCapture:m.openLocaleSelector},{popper:(0,s.k6)((()=>[(0,s.Lk)("ul",d,[m.showNone?(0,s.bo)(((0,s.uX)(),(0,s.CE)("li",{key:0,class:"hand",tabindex:"0",role:"menuitem",onClick:t[0]||(t[0]=(0,a.D$)((e=>m.switchLocale("none")),["stop"])),onKeyup:[t[1]||(t[1]=(0,a.jR)((0,a.D$)((e=>m.switchLocale("none")),["stop"]),["enter"])),t[2]||(t[2]=(0,a.jR)((0,a.D$)((e=>m.switchLocale("none")),["stop"]),["space"]))]},null,544)),[[b,"locale.none"]]):(0,s.Q3)("",!0),t[8]||(t[8]=(0,s.eW)()),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.availableLocales,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,tabindex:"0",role:"menuitem",class:"hand",lang:t,onClick:(0,a.D$)((e=>m.switchLocale(t)),["stop"]),onKeyup:[(0,a.jR)((0,a.D$)((e=>m.switchLocale(t)),["stop"]),["enter"]),(0,a.jR)((0,a.D$)((e=>m.switchLocale(t)),["stop"]),["space"])]},(0,l.v_)(e),41,u)))),128))])])),default:(0,s.k6)((()=>[(0,s.Lk)("a",n,[(0,s.eW)((0,l.v_)(e.selectedLocaleLabel)+" ",1),o.showIcon?((0,s.uX)(),(0,s.CE)("i",c)):(0,s.Q3)("",!0)]),t[9]||(t[9]=(0,s.eW)())])),_:1,__:[9]},8,["shown","onFocusCapture"])],40,r)):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",g,[(0,s.bF)(L,{value:m.selectedOption,options:m.localesOptions,"is-lang-select":!0,"onUpdate:value":t[7]||(t[7]=e=>m.switchLocale(e))},null,8,["value","options"])]))])}var p=o(66278),m=o(360);const v={name:"LocalSelector",components:{Select:m.A},props:{mode:{type:String,default:""},showIcon:{type:Boolean,default:!0}},data(){return{isLocaleSelectorOpen:!1}},computed:{...(0,p.L8)("i18n",["selectedLocaleLabel","availableLocales"]),localesOptions(){return Object.keys(this.availableLocales).map((e=>({label:this.t(`locale.${e}`),value:e})))},selectedOption(){return Object.keys(this.availableLocales)[Object.values(this.availableLocales).indexOf(this.selectedLocaleLabel)]},showLocale(){return this.availableLocales&&Object.keys(this.availableLocales).length>1||this.dev},showNone(){return!1}},methods:{openLocaleSelector(){this.isLocaleSelectorOpen=!0},closeLocaleSelector(){this.isLocaleSelectorOpen=!1},switchLocale(e){this.$store.dispatch("i18n/switchTo",e),this.closeLocaleSelector()}}};o(72053);var L=o(66262);const b=(0,L.A)(v,[["render",h],["__scopeId","data-v-79068706"]]),f=b},88343:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Z});var s=o(20641),a=o(90033),l=o(53751);const i={key:1,class:"main-layout login"},r={class:"row gutless mb-20"},n={class:"col span-6 p-20"},c={class:"text-center"},d={class:"text-center login-welcome"},u={key:1,class:"text-success text-center"},g={key:2,class:"text-error text-center"},h={class:"span-6 offset-3"},p={class:"mb-20"},m={class:""},v={class:"mt-20"},L={class:"col span-12 text-center"},b={key:0,class:"mt-20"},f={key:1,class:"mt-20 text-center"},k={key:2,class:"mt-20 text-center"},w={key:3,class:"locale-selector"};function y(e,t,o,y,S,C){const E=(0,s.g2)("Loading"),$=(0,s.g2)("Banner"),x=(0,s.g2)("t"),O=(0,s.g2)("CopyCode"),I=(0,s.g2)("LabeledInput"),_=(0,s.g2)("Password"),N=(0,s.g2)("AsyncButton"),R=(0,s.g2)("Checkbox"),W=(0,s.g2)("LocaleSelector"),P=(0,s.g2)("BrandImage");return e.$fetchState.pending?((0,s.uX)(),(0,s.Wv)(E,{key:0,mode:"relative"})):((0,s.uX)(),(0,s.CE)("main",i,[(0,s.Lk)("div",r,[(0,s.Lk)("div",n,[(0,s.Lk)("p",c,(0,a.v_)(e.t("login.howdy")),1),t[26]||(t[26]=(0,s.eW)()),(0,s.Lk)("h1",d,(0,a.v_)(e.t("login.welcome",{vendor:S.vendor})),1),t[27]||(t[27]=(0,s.eW)()),(0,s.Lk)("div",{class:(0,a.C4)(["login-messages",{"login-messages--hasContent":C.hasLoginMessage}]),"data-testid":"login__messages"},[C.errorToDisplay?((0,s.uX)(),(0,s.Wv)($,{key:0,label:C.errorToDisplay,color:"error"},null,8,["label"])):S.loggedOut?((0,s.uX)(),(0,s.CE)("h4",u,(0,a.v_)(C.loggedOutSuccessMsg),1)):S.timedOut?((0,s.uX)(),(0,s.CE)("h4",g,(0,a.v_)(e.t("login.loginAgain")),1)):(0,s.Q3)("",!0)],2),t[28]||(t[28]=(0,s.eW)()),S.firstLogin?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,a.C4)(["first-login-message pl-10 pr-10",{"mt-30":!C.hasLoginMessage}]),"data-testid":"first-login-message"},[(0,s.bF)(x,{k:"setup.defaultPassword.intro",raw:!0}),t[9]||(t[9]=(0,s.eW)()),(0,s.Lk)("div",null,[(0,s.bF)(x,{k:"setup.defaultPassword.dockerPrefix",raw:!0})]),t[10]||(t[10]=(0,s.eW)()),(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,[(0,s.bF)(x,{k:"setup.defaultPassword.dockerPs",raw:!0})]),t[8]||(t[8]=(0,s.eW)()),(0,s.Lk)("li",null,[(0,s.bF)(O,null,{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("\n                docker logs "),(0,s.Lk)("u",null,"container-id",-1),(0,s.eW)(' 2>&1 | grep "Bootstrap Password:"\n              ')]))),_:1,__:[7]})])]),t[11]||(t[11]=(0,s.eW)()),(0,s.Lk)("div",null,[(0,s.bF)(x,{k:"setup.defaultPassword.dockerSuffix",raw:!0})]),t[12]||(t[12]=(0,s.eW)()),t[13]||(t[13]=(0,s.Lk)("br",null,null,-1)),t[14]||(t[14]=(0,s.eW)()),(0,s.Lk)("div",null,[(0,s.bF)(x,{k:"setup.defaultPassword.helmPrefix",raw:!0})]),t[15]||(t[15]=(0,s.eW)()),t[16]||(t[16]=(0,s.Lk)("br",null,null,-1)),t[17]||(t[17]=(0,s.eW)()),(0,s.bF)(O,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(C.kubectlCmd),1)])),_:1}),t[18]||(t[18]=(0,s.eW)()),t[19]||(t[19]=(0,s.Lk)("br",null,null,-1)),t[20]||(t[20]=(0,s.eW)()),(0,s.Lk)("div",null,[(0,s.bF)(x,{k:"setup.defaultPassword.helmSuffix",raw:!0})])],2)):(0,s.Q3)("",!0),t[29]||(t[29]=(0,s.eW)()),(!S.hasLocal||S.hasLocal&&!S.showLocal)&&S.providers.length?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,a.C4)({"mt-30":!C.hasLoginMessage})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(S.providers,((e,o)=>((0,s.uX)(),(0,s.Wv)((0,s.$y)(S.providerComponents[o]),{key:o,class:"mb-10","focus-on-mount":0===o&&!S.showLocal,name:e,open:!S.showLocal,onShowInputs:t[0]||(t[0]=e=>S.showLocal=!1),onError:C.handleProviderError},null,40,["focus-on-mount","name","open","onError"])))),128))],2)):(0,s.Q3)("",!0),t[30]||(t[30]=(0,s.eW)()),S.hasLocal?((0,s.uX)(),(0,s.CE)(s.FK,{key:2},[S.showLocal?((0,s.uX)(),(0,s.CE)("form",{key:0,class:(0,a.C4)({"mt-30":!C.hasLoginMessage}),onSubmit:t[4]||(t[4]=(0,l.D$)((()=>{}),["prevent"]))},[(0,s.Lk)("div",h,[(0,s.Lk)("div",p,[S.firstLogin?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(I,{key:0,ref:"username",value:S.username,"onUpdate:value":t[1]||(t[1]=e=>S.username=e),valueModifiers:{trim:!0},"data-testid":"local-login-username",label:e.t("login.username"),autocomplete:"username"},null,8,["value","label"]))]),t[21]||(t[21]=(0,s.eW)()),(0,s.Lk)("div",m,[(0,s.bF)(_,{ref:"password",value:S.password,"onUpdate:value":t[2]||(t[2]=e=>S.password=e),"data-testid":"local-login-password",label:e.t("login.password"),autocomplete:"password"},null,8,["value","label"])])]),t[23]||(t[23]=(0,s.eW)()),(0,s.Lk)("div",v,[(0,s.Lk)("div",L,[(0,s.bF)(N,{id:"submit","data-testid":"login-submit",type:"submit","action-label":e.t("login.loginWithLocal"),"waiting-label":e.t("login.loggingIn"),"success-label":e.t("login.loggedIn"),"error-label":e.t("asyncButton.default.error"),onClick:C.loginLocal},null,8,["action-label","waiting-label","success-label","error-label","onClick"]),t[22]||(t[22]=(0,s.eW)()),S.firstLogin?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",b,[(0,s.bF)(R,{value:S.remember,"onUpdate:value":t[3]||(t[3]=e=>S.remember=e),label:e.t("login.remember.label"),type:"checkbox"},null,8,["value","label"])]))])])],34)):(0,s.Q3)("",!0),t[24]||(t[24]=(0,s.eW)()),S.hasLocal&&!S.showLocal?((0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("a",{id:"login-useLocal","data-testid":"login-useLocal",role:"button",onClick:t[5]||(t[5]=(...e)=>C.toggleLocal&&C.toggleLocal(...e))},(0,a.v_)(e.t("login.useLocal")),1)])):(0,s.Q3)("",!0),t[25]||(t[25]=(0,s.eW)()),S.hasLocal&&S.showLocal&&S.providers.length?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("a",{role:"button",onClick:t[6]||(t[6]=(...e)=>C.toggleLocal&&C.toggleLocal(...e))},(0,a.v_)(C.nonLocalPrompt),1)])):(0,s.Q3)("",!0)],64)):(0,s.Q3)("",!0),t[31]||(t[31]=(0,s.eW)()),S.showLocaleSelector&&e.hasMultipleLocales&&!C.isHarvester?((0,s.uX)(),(0,s.CE)("div",w,[(0,s.bF)(W,{mode:"login"})])):(0,s.Q3)("",!0)]),t[32]||(t[32]=(0,s.eW)()),(0,s.bF)(P,{class:"col span-6 landscape","data-testid":"login-landscape__img","file-name":"login-landscape.svg"})])]))}var S=o(65843),C=o(26685),E=o(16372),$=o(97671),x=o(55446),O=o(64430),I=o(1974),_=o(64391),N=o(14492),R=o(46405),W=o(35800),P=o(54085),T=o(18561),A=o(14026),G=o(66278),F=o(50953),M=o(21324),X=o(55823),Q=o(95822),H=o(82943),D=o(10874),B=o(51229),j=o(38928),U=o(71883);const K={name:"Login",components:{LabeledInput:E.o,AsyncButton:$.A,Checkbox:W.S,BrandImage:O.A,Banner:N.l,InfoBox:I.A,CopyCode:_.A,Password:P.A,LocaleSelector:x.A,Loading:j.A},data(){const e=this.$cookies.get(C.HF,{parseJSON:!1})||"";return{username:e,remember:!!e,password:"",timedOut:this.$route.query[R.VP]===R.Qp,loggedOut:this.$route.query[R.gZ]===R.Qp,isSsoLogout:this.$route.query[R.r3]===R.Qp,isSlo:this.$route.query[R.kM]===R.Qp,err:this.$route.query.err,showLocaleSelector:!0,hasLocal:!1,showLocal:!1,providers:[],providerComponents:[],customLoginError:{},firstLogin:!1,vendor:(0,D.f7)()}},computed:{...(0,G.L8)(["isSingleProduct"]),...(0,G.L8)({t:"i18n/t",hasMultipleLocales:"i18n/hasMultipleLocales"}),loggedOutSuccessMsg(){return this.isSlo?this.t("login.loggedOutFromSlo"):this.isSsoLogout?this.t("login.loggedOutFromSso"):this.t("login.loggedOut")},isHarvester(){return this.isSingleProduct?.productName===U.T3},singleProvider(){return 1===this.providers.length?this.providers[0]:void 0},nonLocalPrompt(){if(this.singleProvider){const e=this.displayName(this.singleProvider);return this.t("login.useProvider",{provider:e})}return this.t("login.useNonLocal")},errorMessage(){return this.isSlo?this.err?.length?this.t("logout.error",{msg:this.err}):"":this.err===H.LOGIN_ERRORS.CLIENT_UNAUTHORIZED?this.t("login.clientError"):this.err===H.LOGIN_ERRORS.CLIENT||this.err===H.LOGIN_ERRORS.SERVER?this.t("login.error"):this.err===H.LOGIN_ERRORS.NONCE?this.t("login.invalidResponseError"):this.err===H.LOGIN_ERRORS.USER_UNAUTHORIZED?this.t("login.userUnauthorized"):this.err?.length?this.t("login.specificError",{msg:this.err}):""},errorToDisplay(){return"true"===this.customLoginError?.showMessage&&this.customLoginError?.message&&this.errorMessage?`${this.customLoginError.message} \n ${this.errorMessage}`:this.errorMessage?this.errorMessage:""},kubectlCmd(){return"kubectl get secret --namespace cattle-system bootstrap-secret -o go-template='{{.data.bootstrapPassword|base64decode}}{{\"\\n\"}}'"},hasLoginMessage(){return this.errorToDisplay||this.loggedOut||this.timedOut}},async fetch(){const{firstLoginSetting:e}=await this.loadInitialSettings(),{value:t}=await this.$store.dispatch("management/find",{type:X.Mc.SETTING,id:Q.HG.BANNERS}),o=await this.$store.dispatch("auth/getAuthProviders"),s=(0,T.Ul)(o.map((e=>e.id)),["id"]),a=s.includes("local"),l=a&&!!s.find((e=>"local"!==e));a&&(0,S.Gj)(s,"local"),this.vendor=(0,D.f7)(),this.providers=s,this.hasLocal=a,this.showLocal=!l||this.$route.query[R.G8]===R.Qp,this.customLoginError=JSON.parse(t).loginError,this.firstLogin="true"===e?.value,this.username=this.firstLogin?"admin":this.username,this.providerComponents=this.providers.map((e=>(0,F.IG)(this.$store.getters["type-map/importLogin"](A.configType[e]||e)))),this.$nextTick((()=>{this.focusSomething()}))},methods:{async loadInitialSettings(){let e,t,o;try{e=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.FIRST_LOGIN),t=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.PL),o=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.BRAND)}catch(s){e=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.FIRST_LOGIN,opt:{url:`/v3/settings/${Q.HG.FIRST_LOGIN}`}}),t=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.PL,opt:{url:`/v3/settings/${Q.HG.PL}`}}),o=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.BRAND,opt:{url:`/v3/settings/${Q.HG.BRAND}`}})}return t.value?.length&&t.value!==(0,D.f7)()&&(0,D.xc)(t.value),o?.value?.length&&o.value!==(0,D.o7)()&&(0,D.aA)(o.value),{firstLoginSetting:e,plSetting:t,brand:o}},displayName(e){return this.t(`model.authConfig.provider.${e}`)},toggleLocal(){this.showLocal=!this.showLocal,this.$router.applyQuery({[R.G8]:R.Qp}),this.$nextTick((()=>{this.focusSomething()}))},focusSomething(){if(!this.showLocal)return;let e;e=this.username?this.$refs.password:this.$refs.username,e?.focus&&(e.focus(),e.select&&e.select())},handleProviderError(e){this.err=e},async loginLocal(e){try{await this.$store.dispatch("auth/login",{provider:"local",body:{username:this.username,password:this.password}});const e=await this.$store.dispatch("rancher/findAll",{type:X.k$.USER,opt:{url:"/v3/users?me=true",load:M.lh}});e?.[0]&&this.$store.dispatch("auth/gotUser",e[0]),this.remember?this.$cookies.set(C.HF,this.username,{encode:e=>e,maxAge:31536e3,path:"/",sameSite:!0,secure:!0}):this.$cookies.remove(C.HF),await(0,B.A)({app:this.$store.app,store:this.$store,$plugin:this.$store.$plugin}),this.firstLogin||e[0]?.mustChangePassword?(this.$store.dispatch("auth/setInitialPass",this.password),this.$router.push({name:"auth-setup"})):this.$router.push({name:"index"})}catch(t){this.err=t,this.timedOut=null,this.loggedOut=null,e(!1)}}}};o(81375);var q=o(66262);const z=(0,q.A)(K,[["render",y],["__scopeId","data-v-6713391d"]]),Z=z},85515:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var s=o(31601),a=o.n(s),l=o(76314),i=o.n(l),r=o(5111),n=i()(a());n.i(r.A),n.push([e.id,".advanced[data-v-79068706]{-webkit-user-select:none;-moz-user-select:none;user-select:none;padding:0 5px;line-height:40px;font-size:15px;font-weight:500}.content[data-v-79068706]{background:var(--nav-active);padding:10px;margin-top:6px;border-radius:4px}.hand[data-v-79068706]:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:4px}.locale-chooser[data-v-79068706]{cursor:pointer}.locale-chooser[data-v-79068706]:hover{text-decoration:none}.locale-login-container[data-v-79068706]:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}",""]);const c=n},14841:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var s=o(31601),a=o.n(s),l=o(76314),i=o.n(l),r=o(5111),n=i()(a());n.i(r.A),n.push([e.id,".login[data-v-6713391d]{overflow:hidden;position:relative}.login .row[data-v-6713391d]{align-items:center}.login .landscape[data-v-6713391d]{height:100vh;margin:0;-o-object-fit:cover;object-fit:cover}.login .login-welcome[data-v-6713391d]{margin:0}.login .login-messages[data-v-6713391d]{display:flex;justify-content:center;align-items:center}.login .login-messages .banner[data-v-6713391d]{margin:5px}.login .login-messages h4[data-v-6713391d]{margin:0}.login .login-messages--hasContent[data-v-6713391d]{min-height:70px}.login .login-messages .banner[data-v-6713391d],.login .login-messages .text-error[data-v-6713391d]{max-width:80%}.login .first-login-message .banner[data-v-6713391d]{margin-bottom:0;border-left:0}.login .first-login-message .banner[data-v-6713391d]  code{font-size:12px;padding:0}.gutless[data-v-6713391d]{height:100vh}.gutless>.span-6[data-v-6713391d]{overflow-y:auto;display:flex;flex-direction:column;height:100%;place-content:center}.locale-selector[data-v-6713391d]{position:absolute;bottom:30px}",""]);const c=n},72053:(e,t,o)=>{var s=o(85515);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("261e9496",s,!0,{sourceMap:!1,shadowMode:!1})},81375:(e,t,o)=>{var s=o(14841);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(99548).A;a("f3a9dbd2",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=8343.f7374e67.js.map